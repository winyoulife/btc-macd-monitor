<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ğŸš€ BTCå°ˆæ¥­æŠ€è¡“åˆ†æç›´æ’­ç«™ ğŸš€</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(45deg, #0a0a23, #1a1a2e, #16213e);
            color: #00ff88;
            font-family: 'Courier New', monospace;
            overflow-x: hidden;
        }
        
        .header {
            background: rgba(0,0,0,0.9);
            padding: 15px 0;
            text-align: center;
            border-bottom: 2px solid #00ff88;
            position: relative;
        }
        
        .title {
            font-size: 2.5em;
            text-shadow: 0 0 20px #00ff88;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 20px #00ff88; }
            to { text-shadow: 0 0 30px #00ff88, 0 0 40px #00ff88; }
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .price-section {
            background: rgba(0,0,0,0.8);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .current-price {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 0 0 15px #00ff88;
        }
        
        .price-change {
            font-size: 1.5em;
            margin: 10px 0;
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .indicator-box {
            background: rgba(0,20,40,0.8);
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .indicator-title {
            font-size: 1.2em;
            color: #00ff88;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .indicator-value {
            font-size: 1.8em;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .indicator-signal {
            font-size: 1em;
            margin-top: 5px;
            padding: 5px;
            border-radius: 5px;
        }
        
        .bullish { color: #00ff00; background: rgba(0,255,0,0.1); }
        .bearish { color: #ff4444; background: rgba(255,68,68,0.1); }
        .neutral { color: #ffaa00; background: rgba(255,170,0,0.1); }
        
        .chart-container {
            background: rgba(0,0,0,0.8);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            height: 600px;
        }
        
        .signals-section {
            grid-column: 1 / -1;
            background: rgba(0,0,0,0.8);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .signals-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .signal-box {
            background: rgba(0,30,60,0.8);
            border: 2px solid;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .bottom-signal {
            border-color: #00ff00;
            background: rgba(0,255,0,0.05);
        }
        
        .top-signal {
            border-color: #ff4444;
            background: rgba(255,68,68,0.05);
        }
        
        .signal-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .signal-conditions {
            text-align: left;
            margin: 10px 0;
        }
        
        .condition {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        
        .condition.met {
            background: rgba(0,255,0,0.2);
            color: #00ff00;
        }
        
        .condition.not-met {
            background: rgba(255,68,68,0.2);
            color: #ff6666;
        }
        
        .signal-strength {
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
        }
        
        .market-data {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .data-item {
            background: rgba(0,20,40,0.6);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }
        
        .data-label {
            font-size: 0.9em;
            color: #aaa;
        }
        
        .data-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #00ff88;
        }
        
        .update-time {
            text-align: center;
            margin-top: 20px;
            color: #888;
            font-size: 0.9em;
        }
        
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .signals-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">ğŸš€ BTCå°ˆæ¥­æŠ€è¡“åˆ†æç›´æ’­ç«™ ğŸš€</div>
        <div style="margin-top: 10px; font-size: 1.2em;">
            ğŸ’ å¤šæŒ‡æ¨™äº¤å‰ç¢ºèª | ğŸ¯ ç²¾æº–æŠ“è½‰æŠ˜é» | ğŸ“Š å¯¦æ™‚æŠ€è¡“åˆ†æ
        </div>
    </div>

    <div class="main-container">
        <!-- åƒ¹æ ¼é¡¯ç¤ºå€ -->
        <div class="price-section">
            <h2>ğŸ’° BTC/USDT å¯¦æ™‚åƒ¹æ ¼</h2>
            <div class="current-price" id="currentPrice">è¼‰å…¥ä¸­...</div>
            <div class="price-change" id="priceChange">--</div>
            
            <div class="market-data">
                <div class="data-item">
                    <div class="data-label">24H é«˜é»</div>
                    <div class="data-value" id="high24h">--</div>
                </div>
                <div class="data-item">
                    <div class="data-label">24H ä½é»</div>
                    <div class="data-value" id="low24h">--</div>
                </div>
                <div class="data-item">
                    <div class="data-label">24H æˆäº¤é‡</div>
                    <div class="data-value" id="volume24h">--</div>
                </div>
                <div class="data-item">
                    <div class="data-label">å¸‚å€¼æ’å</div>
                    <div class="data-value">#1</div>
                </div>
            </div>
            
            <!-- æŠ€è¡“æŒ‡æ¨™é¡¯ç¤º -->
            <div class="indicators-grid">
                <div class="indicator-box">
                    <div class="indicator-title">MACD (12,26,9)</div>
                    <div class="indicator-value" id="macdValue">--</div>
                    <div class="indicator-signal" id="macdSignal">è¨ˆç®—ä¸­...</div>
                </div>
                
                <div class="indicator-box">
                    <div class="indicator-title">RSI (14)</div>
                    <div class="indicator-value" id="rsiValue">--</div>
                    <div class="indicator-signal" id="rsiSignal">è¨ˆç®—ä¸­...</div>
                </div>
                
                <div class="indicator-box">
                    <div class="indicator-title">å¸ƒæ—é€šé“</div>
                    <div class="indicator-value" id="bbValue">--</div>
                    <div class="indicator-signal" id="bbSignal">è¨ˆç®—ä¸­...</div>
                </div>
                
                <div class="indicator-box">
                    <div class="indicator-title">å‡ç·šè¶¨å‹¢</div>
                    <div class="indicator-value" id="maValue">--</div>
                    <div class="indicator-signal" id="maSignal">è¨ˆç®—ä¸­...</div>
                </div>
            </div>
        </div>

        <!-- åœ–è¡¨å€ -->
        <div class="chart-container">
            <canvas id="priceChart"></canvas>
        </div>
    </div>

    <!-- äº¤æ˜“è¨Šè™Ÿåˆ†æå€ -->
    <div class="signals-section">
        <h2 style="text-align: center; margin-bottom: 20px; font-size: 1.8em;">
            ğŸ¯ è½‰æŠ˜é»è¨Šè™Ÿåˆ†æ - å¤šæŒ‡æ¨™äº¤å‰ç¢ºèª
        </h2>
        
        <div class="signals-grid">
            <!-- åº•éƒ¨åå½ˆè¨Šè™Ÿ -->
            <div class="signal-box bottom-signal">
                <div class="signal-title" style="color: #00ff00;">
                    ğŸ“‰ åº•éƒ¨åå½ˆè¨Šè™Ÿæª¢æ¸¬
                </div>
                
                <div class="signal-conditions">
                    <div class="condition" id="macdBullish">
                        ğŸ”¸ MACDé‡‘å‰ + æŸ±ç‹€åœ–è½‰ç¶ 
                    </div>
                    <div class="condition" id="rsiBullish">
                        ğŸ”¸ RSI < 30 é–‹å§‹å‘ä¸Šå½
                    </div>
                    <div class="condition" id="maBullish">
                        ğŸ”¸ Kç·šç«™å›MA5/MA10
                    </div>
                    <div class="condition" id="bbBullish">
                        ğŸ”¸ è·Œç ´ä¸‹è»Œå¾Œæ”¶å›è»Œå…§
                    </div>
                    <div class="condition" id="volumeBullish">
                        ğŸ”¸ åå½ˆæ™‚æ”¾é‡ç¢ºèª
                    </div>
                </div>
                
                <div class="signal-strength" id="bullishStrength">
                    è¨Šè™Ÿå¼·åº¦: è¨ˆç®—ä¸­...
                </div>
            </div>

            <!-- é«˜é»å›æ¸¬è¨Šè™Ÿ -->
            <div class="signal-box top-signal">
                <div class="signal-title" style="color: #ff4444;">
                    ğŸ“ˆ é«˜é»å›æ¸¬è¨Šè™Ÿæª¢æ¸¬
                </div>
                
                <div class="signal-conditions">
                    <div class="condition" id="macdBearish">
                        ğŸ”¸ MACDæ­»å‰ + æŸ±ç‹€åœ–è½‰ç´…
                    </div>
                    <div class="condition" id="rsiBearish">
                        ğŸ”¸ RSI > 70 å‡ºç¾ä¸‹å½
                    </div>
                    <div class="condition" id="maBearish">
                        ğŸ”¸ Kç·šè·Œç ´MA5/MA10
                    </div>
                    <div class="condition" id="bbBearish">
                        ğŸ”¸ è¡ç ´ä¸Šè»Œä½†æ‹‰å›
                    </div>
                    <div class="condition" id="volumeBearish">
                        ğŸ”¸ é«˜é»çˆ†é‡æˆ–ä¸Šæ¼²ç„¡é‡
                    </div>
                </div>
                
                <div class="signal-strength" id="bearishStrength">
                    è¨Šè™Ÿå¼·åº¦: è¨ˆç®—ä¸­...
                </div>
            </div>
        </div>
    </div>

    <div class="update-time" id="updateTime">
        æœ€å¾Œæ›´æ–°: --
    </div>

    <script>
        // å…¨å±€è®Šæ•¸
        let priceData = [];
        let priceChart;
        let currentPrice = 0;
        let previousPrice = 0;

        // åˆå§‹åŒ–åœ–è¡¨
        function initChart() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'BTC Price',
                        data: [],
                        borderColor: '#00ff88',
                        backgroundColor: 'rgba(0,255,136,0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'MA5',
                        data: [],
                        borderColor: '#ffaa00',
                        borderWidth: 1,
                        fill: false
                    }, {
                        label: 'MA10',
                        data: [],
                        borderColor: '#ff6600',
                        borderWidth: 1,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#00ff88'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#00ff88' },
                            grid: { color: 'rgba(0,255,136,0.2)' }
                        },
                        y: {
                            ticks: { color: '#00ff88' },
                            grid: { color: 'rgba(0,255,136,0.2)' }
                        }
                    }
                }
            });
        }

        // è¨ˆç®—æŠ€è¡“æŒ‡æ¨™
        function calculateIndicators(prices) {
            if (prices.length < 26) return null;
            
            // è¨ˆç®—MACD
            const macd = calculateMACD(prices);
            
            // è¨ˆç®—RSI
            const rsi = calculateRSI(prices, 14);
            
            // è¨ˆç®—å¸ƒæ—é€šé“
            const bb = calculateBollingerBands(prices, 20, 2);
            
            // è¨ˆç®—ç§»å‹•å¹³å‡
            const ma5 = calculateMA(prices, 5);
            const ma10 = calculateMA(prices, 10);
            
            return { macd, rsi, bb, ma5, ma10 };
        }

        // MACDè¨ˆç®—
        function calculateMACD(prices) {
            const ema12 = calculateEMA(prices, 12);
            const ema26 = calculateEMA(prices, 26);
            
            if (!ema12 || !ema26) return null;
            
            const macdLine = ema12 - ema26;
            const signal = calculateEMA([macdLine], 9);
            const histogram = macdLine - (signal || 0);
            
            return { macdLine, signal, histogram };
        }

        // RSIè¨ˆç®—
        function calculateRSI(prices, period) {
            if (prices.length < period + 1) return null;
            
            let gains = 0, losses = 0;
            
            for (let i = prices.length - period; i < prices.length; i++) {
                const change = prices[i] - prices[i-1];
                if (change > 0) gains += change;
                else losses -= change;
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            
            if (avgLoss === 0) return 100;
            
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }

        // å¸ƒæ—é€šé“è¨ˆç®—
        function calculateBollingerBands(prices, period, multiplier) {
            if (prices.length < period) return null;
            
            const recentPrices = prices.slice(-period);
            const sma = recentPrices.reduce((a, b) => a + b) / period;
            
            const variance = recentPrices.reduce((sum, price) => {
                return sum + Math.pow(price - sma, 2);
            }, 0) / period;
            
            const stdDev = Math.sqrt(variance);
            
            return {
                upper: sma + (stdDev * multiplier),
                middle: sma,
                lower: sma - (stdDev * multiplier)
            };
        }

        // EMAè¨ˆç®—
        function calculateEMA(prices, period) {
            if (prices.length < period) return null;
            
            const multiplier = 2 / (period + 1);
            let ema = prices[0];
            
            for (let i = 1; i < prices.length; i++) {
                ema = (prices[i] * multiplier) + (ema * (1 - multiplier));
            }
            
            return ema;
        }

        // ç§»å‹•å¹³å‡è¨ˆç®—
        function calculateMA(prices, period) {
            if (prices.length < period) return null;
            
            const recentPrices = prices.slice(-period);
            return recentPrices.reduce((a, b) => a + b) / period;
        }

        // æ›´æ–°æŠ€è¡“æŒ‡æ¨™é¡¯ç¤º
        function updateIndicators(indicators) {
            if (!indicators) return;
            
            // æ›´æ–°MACD
            if (indicators.macd) {
                document.getElementById('macdValue').textContent = 
                    indicators.macd.macdLine.toFixed(2);
                
                const macdSignal = indicators.macd.histogram > 0 ? 
                    (indicators.macd.macdLine > indicators.macd.signal ? 'ğŸŸ¢ é‡‘å‰' : 'ğŸŸ¡ å¤šé ­') :
                    'ğŸ”´ æ­»å‰';
                document.getElementById('macdSignal').textContent = macdSignal;
                document.getElementById('macdSignal').className = 
                    `indicator-signal ${indicators.macd.histogram > 0 ? 'bullish' : 'bearish'}`;
            }
            
            // æ›´æ–°RSI
            if (indicators.rsi) {
                document.getElementById('rsiValue').textContent = 
                    indicators.rsi.toFixed(1);
                
                let rsiSignal, rsiClass;
                if (indicators.rsi < 30) {
                    rsiSignal = 'ğŸŸ¢ è¶…è³£';
                    rsiClass = 'bullish';
                } else if (indicators.rsi > 70) {
                    rsiSignal = 'ğŸ”´ è¶…è²·';
                    rsiClass = 'bearish';
                } else {
                    rsiSignal = 'ğŸŸ¡ ä¸­æ€§';
                    rsiClass = 'neutral';
                }
                
                document.getElementById('rsiSignal').textContent = rsiSignal;
                document.getElementById('rsiSignal').className = `indicator-signal ${rsiClass}`;
            }
            
            // æ›´æ–°å¸ƒæ—é€šé“
            if (indicators.bb) {
                const currentPrice = priceData[priceData.length - 1];
                let bbSignal, bbClass;
                
                if (currentPrice < indicators.bb.lower) {
                    bbSignal = 'ğŸŸ¢ è·Œç ´ä¸‹è»Œ';
                    bbClass = 'bullish';
                } else if (currentPrice > indicators.bb.upper) {
                    bbSignal = 'ğŸ”´ çªç ´ä¸Šè»Œ';
                    bbClass = 'bearish';
                } else {
                    bbSignal = 'ğŸŸ¡ è»Œé“å…§';
                    bbClass = 'neutral';
                }
                
                document.getElementById('bbValue').textContent = 
                    `${indicators.bb.upper.toFixed(0)} / ${indicators.bb.lower.toFixed(0)}`;
                document.getElementById('bbSignal').textContent = bbSignal;
                document.getElementById('bbSignal').className = `indicator-signal ${bbClass}`;
            }
            
            // æ›´æ–°å‡ç·š
            if (indicators.ma5 && indicators.ma10) {
                const currentPrice = priceData[priceData.length - 1];
                let maSignal, maClass;
                
                if (currentPrice > indicators.ma5 && indicators.ma5 > indicators.ma10) {
                    maSignal = 'ğŸŸ¢ å¤šé ­æ’åˆ—';
                    maClass = 'bullish';
                } else if (currentPrice < indicators.ma5 && indicators.ma5 < indicators.ma10) {
                    maSignal = 'ğŸ”´ ç©ºé ­æ’åˆ—';
                    maClass = 'bearish';
                } else {
                    maSignal = 'ğŸŸ¡ ç›¤æ•´';
                    maClass = 'neutral';
                }
                
                document.getElementById('maValue').textContent = 
                    `MA5: ${indicators.ma5.toFixed(0)} | MA10: ${indicators.ma10.toFixed(0)}`;
                document.getElementById('maSignal').textContent = maSignal;
                document.getElementById('maSignal').className = `indicator-signal ${maClass}`;
            }
        }

        // æ›´æ–°äº¤æ˜“è¨Šè™Ÿ
        function updateTradingSignals(indicators) {
            if (!indicators) return;
            
            let bullishCount = 0, bearishCount = 0;
            
            // æª¢æŸ¥åº•éƒ¨åå½ˆæ¢ä»¶
            const macdBullish = indicators.macd && indicators.macd.histogram > 0;
            const rsiBullish = indicators.rsi && indicators.rsi < 30;
            const maBullish = indicators.ma5 && indicators.ma10 && 
                             priceData[priceData.length - 1] > indicators.ma5;
            const bbBullish = indicators.bb && 
                             priceData[priceData.length - 1] > indicators.bb.lower;
            const volumeBullish = true; // ç°¡åŒ–è™•ç†
            
            // æ›´æ–°åº•éƒ¨åå½ˆæ¢ä»¶é¡¯ç¤º
            updateCondition('macdBullish', macdBullish);
            updateCondition('rsiBullish', rsiBullish);
            updateCondition('maBullish', maBullish);
            updateCondition('bbBullish', bbBullish);
            updateCondition('volumeBullish', volumeBullish);
            
            bullishCount = [macdBullish, rsiBullish, maBullish, bbBullish, volumeBullish]
                          .filter(Boolean).length;
            
            // æª¢æŸ¥é«˜é»å›æ¸¬æ¢ä»¶
            const macdBearish = indicators.macd && indicators.macd.histogram < 0;
            const rsiBearish = indicators.rsi && indicators.rsi > 70;
            const maBearish = indicators.ma5 && indicators.ma10 && 
                             priceData[priceData.length - 1] < indicators.ma5;
            const bbBearish = indicators.bb && 
                             priceData[priceData.length - 1] > indicators.bb.upper;
            const volumeBearish = false; // ç°¡åŒ–è™•ç†
            
            // æ›´æ–°é«˜é»å›æ¸¬æ¢ä»¶é¡¯ç¤º
            updateCondition('macdBearish', macdBearish);
            updateCondition('rsiBearish', rsiBearish);
            updateCondition('maBearish', maBearish);
            updateCondition('bbBearish', bbBearish);
            updateCondition('volumeBearish', volumeBearish);
            
            bearishCount = [macdBearish, rsiBearish, maBearish, bbBearish, volumeBearish]
                          .filter(Boolean).length;
            
            // æ›´æ–°è¨Šè™Ÿå¼·åº¦
            updateSignalStrength('bullishStrength', bullishCount, 'åº•éƒ¨åå½ˆ');
            updateSignalStrength('bearishStrength', bearishCount, 'é«˜é»å›æ¸¬');
        }

        function updateCondition(id, met) {
            const element = document.getElementById(id);
            element.className = `condition ${met ? 'met' : 'not-met'}`;
        }

        function updateSignalStrength(id, count, type) {
            const element = document.getElementById(id);
            const percentage = (count / 5) * 100;
            
            let strengthText, className;
            if (percentage >= 80) {
                strengthText = `ğŸ”¥ ${type}æ©Ÿç‡æ¥µé«˜ (${count}/5)`;
                className = 'bullish';
            } else if (percentage >= 60) {
                strengthText = `âš¡ ${type}æ©Ÿç‡é«˜ (${count}/5)`;
                className = 'neutral';
            } else if (percentage >= 40) {
                strengthText = `âš ï¸ ${type}æ©Ÿç‡ä¸­ç­‰ (${count}/5)`;
                className = 'neutral';
            } else {
                strengthText = `âŒ ${type}æ©Ÿç‡ä½ (${count}/5)`;
                className = 'bearish';
            }
            
            element.textContent = strengthText;
            element.className = `signal-strength ${className}`;
        }

        // ç²å–BTCåƒ¹æ ¼
        async function fetchBTCPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_high_low_24h=true');
                const data = await response.json();
                
                previousPrice = currentPrice;
                currentPrice = data.bitcoin.usd;
                
                // æ›´æ–°åƒ¹æ ¼é¡¯ç¤º
                document.getElementById('currentPrice').textContent = 
                    `$${currentPrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                
                // æ›´æ–°åƒ¹æ ¼è®ŠåŒ–
                const change = data.bitcoin.usd_24h_change;
                const changeElement = document.getElementById('priceChange');
                changeElement.textContent = 
                    `24H: ${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                changeElement.style.color = change >= 0 ? '#00ff00' : '#ff4444';
                
                // æ›´æ–°å¸‚å ´æ•¸æ“š
                document.getElementById('high24h').textContent = 
                    `$${data.bitcoin.usd_24h_high?.toLocaleString() || '--'}`;
                document.getElementById('low24h').textContent = 
                    `$${data.bitcoin.usd_24h_low?.toLocaleString() || '--'}`;
                document.getElementById('volume24h').textContent = 
                    `$${(data.bitcoin.usd_24h_vol / 1000000000).toFixed(1)}B`;
                
                // æ·»åŠ åˆ°åƒ¹æ ¼æ•¸æ“š
                priceData.push(currentPrice);
                if (priceData.length > 100) {
                    priceData.shift();
                }
                
                // è¨ˆç®—æŠ€è¡“æŒ‡æ¨™
                const indicators = calculateIndicators(priceData);
                updateIndicators(indicators);
                updateTradingSignals(indicators);
                
                // æ›´æ–°åœ–è¡¨
                updateChart();
                
                // æ›´æ–°æ™‚é–“
                document.getElementById('updateTime').textContent = 
                    `æœ€å¾Œæ›´æ–°: ${new Date().toLocaleString('zh-TW')}`;
                
            } catch (error) {
                console.error('ç²å–åƒ¹æ ¼å¤±æ•—:', error);
                document.getElementById('currentPrice').textContent = 'ç²å–å¤±æ•—';
            }
        }

        // æ›´æ–°åœ–è¡¨
        function updateChart() {
            if (!priceChart || priceData.length === 0) return;
            
            const labels = priceData.map((_, index) => {
                const time = new Date(Date.now() - (priceData.length - 1 - index) * 30000);
                return time.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'});
            });
            
            priceChart.data.labels = labels;
            priceChart.data.datasets[0].data = priceData;
            
            // è¨ˆç®—ä¸¦æ·»åŠ ç§»å‹•å¹³å‡ç·š
            if (priceData.length >= 5) {
                const ma5Data = priceData.map((_, index) => {
                    if (index < 4) return null;
                    return calculateMA(priceData.slice(index - 4, index + 1), 5);
                });
                priceChart.data.datasets[1].data = ma5Data;
            }
            
            if (priceData.length >= 10) {
                const ma10Data = priceData.map((_, index) => {
                    if (index < 9) return null;
                    return calculateMA(priceData.slice(index - 9, index + 1), 10);
                });
                priceChart.data.datasets[2].data = ma10Data;
            }
            
            priceChart.update('none');
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initChart();
            fetchBTCPrice();
            
            // æ¯30ç§’æ›´æ–°ä¸€æ¬¡
            setInterval(fetchBTCPrice, 30000);
        });
    </script>
</body>
</html> 
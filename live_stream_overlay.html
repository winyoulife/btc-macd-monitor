<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ AI Crypto Analysis - Live Stream | AIÂä†ÂØÜË≤®Âπ£ÂàÜÊûêÁõ¥Êí≠</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0f1419 0%, #1a1a2e 50%, #16213e 100%);
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            color: white;
            overflow: hidden;
            height: 100vh;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 15px;
            padding: 15px;
            height: 100vh;
            max-height: 100vh;
        }
        
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .header {
            background: linear-gradient(45deg, #2d3748, #4a5568);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid #00d4ff;
            box-shadow: 0 8px 32px rgba(0, 212, 255, 0.3);
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #00d4ff;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 14px;
            color: #a0aec0;
        }
        
        .price-section {
            background: linear-gradient(45deg, #1a202c, #2d3748);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 2px solid #48bb78;
            box-shadow: 0 8px 32px rgba(72, 187, 120, 0.2);
        }
        
        .price-display {
            font-size: 48px;
            font-weight: bold;
            color: #48bb78;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(72, 187, 120, 0.5);
        }
        
        .price-change {
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .ai-recommendation {
            background: linear-gradient(45deg, #2d3748, #4a5568);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .rec-header {
            font-size: 18px;
            font-weight: bold;
            color: #00d4ff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rec-action {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .rec-confidence {
            font-size: 16px;
            color: #a0aec0;
        }
        
        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .indicator {
            background: linear-gradient(45deg, #1a202c, #2d3748);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid #4a5568;
        }
        
        .indicator-name {
            font-size: 12px;
            color: #a0aec0;
            margin-bottom: 5px;
        }
        
        .indicator-value {
            font-size: 16px;
            font-weight: bold;
        }
        
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 100vh;
            overflow: hidden;
        }
        
        .info-section {
            background: linear-gradient(45deg, #1a202c, #2d3748);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #4a5568;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            color: #00d4ff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }
        
        .info-label {
            font-size: 12px;
            color: #a0aec0;
        }
        
        .info-value {
            font-size: 12px;
            font-weight: bold;
        }
        
        .probability-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .prob-item {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .prob-label {
            font-size: 12px;
            color: #a0aec0;
            margin-bottom: 5px;
        }
        
        .prob-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .bullish { color: #48bb78; }
        .bearish { color: #f56565; }
        .neutral { color: #ed8936; }
        .positive { color: #48bb78; }
        .negative { color: #f56565; }
        
        .news-sentiment {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .sentiment-item {
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .sentiment-label {
            font-size: 10px;
            color: #a0aec0;
            margin-bottom: 3px;
        }
        
        .sentiment-value {
            font-size: 14px;
            font-weight: bold;
        }
        
        .trading-advice {
            background: linear-gradient(45deg, #2d3748, #4a5568);
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
            text-align: center;
        }
        
        .advice-text {
            font-size: 13px;
            line-height: 1.4;
            color: #e2e8f0;
        }
        
        .footer {
            background: linear-gradient(45deg, #1a202c, #2d3748);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            font-size: 11px;
            color: #a0aec0;
            border: 1px solid #4a5568;
        }
        
        .language-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 212, 255, 0.2);
            border: 1px solid #00d4ff;
            border-radius: 20px;
            padding: 5px 10px;
            font-size: 12px;
            color: #00d4ff;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .language-toggle:hover {
            background: rgba(0, 212, 255, 0.4);
        }
        
        .bilingual {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .zh {
            font-size: 14px;
        }
        
        .en {
            font-size: 11px;
            color: #a0aec0;
        }
    </style>
</head>
<body>
    <div class="language-toggle" onclick="toggleLanguage()">‰∏≠/EN</div>
    
    <div class="main-container">
        <div class="left-panel">
            <div class="header">
                <div class="logo">ü§ñ AIÂ∞àÊ•≠ÊäÄË°ìÂàÜÊûê | AI Professional Technical Analysis</div>
                <div class="subtitle">Âç≥ÊôÇÂä†ÂØÜË≤®Âπ£ÂàÜÊûê | Real-time Cryptocurrency Analysis</div>
            </div>
            
            <div class="price-section">
                <div class="price-display" id="currentPrice">ËºâÂÖ•‰∏≠... | Loading...</div>
                <div class="price-change" id="priceChange">--</div>
                
                <div class="ai-recommendation">
                    <div class="rec-header">
                        <span>üéØ</span>
                        <div class="bilingual">
                            <div class="zh">AIÂª∫Ë≠∞</div>
                            <div class="en">AI Recommendation</div>
                        </div>
                    </div>
                    <div class="rec-action" id="aiRecommendation">ÂàÜÊûê‰∏≠... | Analyzing...</div>
                    <div class="rec-confidence" id="aiConfidence">ÁΩÆ‰ø°Â∫¶ | Confidence: --</div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="section-title">
                    <span>üìä</span>
                    <div class="bilingual">
                        <div class="zh">ÈóúÈçµÊäÄË°ìÊåáÊ®ô</div>
                        <div class="en">Key Technical Indicators</div>
                    </div>
                </div>
                <div class="indicators-grid">
                    <div class="indicator">
                        <div class="indicator-name">MA7</div>
                        <div class="indicator-value" id="ma7">--</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-name">MA25</div>
                        <div class="indicator-value" id="ma25">--</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-name">MACD</div>
                        <div class="indicator-value" id="macd">--</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-name">RSI</div>
                        <div class="indicator-value" id="rsi">--</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-name">Â∏ÉÊûóÂ∏∂ | BB</div>
                        <div class="indicator-value" id="bollinger">--</div>
                    </div>
                    <div class="indicator">
                        <div class="indicator-name">Êàê‰∫§Èáè | Volume</div>
                        <div class="indicator-value" id="volume">--</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="info-section">
                <div class="section-title">
                    <span>üè†</span>
                    <div class="bilingual">
                        <div class="zh">Â∏ÇÂ†¥Ê¶ÇÊ≥Å</div>
                        <div class="en">Market Overview</div>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">24H ÊúÄÈ´ò | 24H High:</span>
                        <span class="info-value positive" id="high24h">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">24H ÊúÄ‰Ωé | 24H Low:</span>
                        <span class="info-value negative" id="low24h">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Áï∂ÂâçÂÉπÊ†º | Current:</span>
                        <span class="info-value" id="currentPriceSmall">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">24H Êàê‰∫§Èáè | Volume:</span>
                        <span class="info-value" id="volume24h">--</span>
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="section-title">
                    <span>üéØ</span>
                    <div class="bilingual">
                        <div class="zh">Ê¶ÇÁéáÂàÜÊûê</div>
                        <div class="en">Probability Analysis</div>
                    </div>
                </div>
                <div class="probability-section">
                    <div class="prob-item">
                        <div class="prob-label">‰∏äÊº≤Ê¶ÇÁéá | Bullish Prob</div>
                        <div class="prob-value bullish" id="bullishProb">--</div>
                    </div>
                    <div class="prob-item">
                        <div class="prob-label">‰∏ãË∑åÊ¶ÇÁéá | Bearish Prob</div>
                        <div class="prob-value bearish" id="bearishProb">--</div>
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="section-title">
                    <span>üì∞</span>
                    <div class="bilingual">
                        <div class="zh">Êñ∞ËÅûÊÉÖÁ∑í</div>
                        <div class="en">News Sentiment</div>
                    </div>
                </div>
                <div class="news-sentiment">
                    <div class="sentiment-item">
                        <div class="sentiment-label">Âà©Â§ö | Positive</div>
                        <div class="sentiment-value bullish" id="positiveNews">--</div>
                    </div>
                    <div class="sentiment-item">
                        <div class="sentiment-label">‰∏≠ÊÄß | Neutral</div>
                        <div class="sentiment-value neutral" id="neutralNews">--</div>
                    </div>
                    <div class="sentiment-item">
                        <div class="sentiment-label">Âà©Á©∫ | Negative</div>
                        <div class="sentiment-value bearish" id="negativeNews">--</div>
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="section-title">
                    <span>üí°</span>
                    <div class="bilingual">
                        <div class="zh">Êìç‰ΩúÂª∫Ë≠∞</div>
                        <div class="en">Trading Advice</div>
                    </div>
                </div>
                <div class="trading-advice">
                    <div class="advice-text" id="tradingAdvice">Ê≠£Âú®ÂàÜÊûêÂ∏ÇÂ†¥ÊÉÖÊ≥Å... | Analyzing market conditions...</div>
                </div>
            </div>
            
            <div class="footer">
                <div class="bilingual">
                    <div class="zh">üöÄ AIÈ©ÖÂãïÁöÑÂ∞àÊ•≠ÂàÜÊûê ‚Ä¢ ÂØ¶ÊôÇÊõ¥Êñ∞ ‚Ä¢ ÂÉÖ‰æõÂèÉËÄÉ</div>
                    <div class="en">üöÄ AI-Powered Professional Analysis ‚Ä¢ Real-time Updates ‚Ä¢ For Reference Only</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentLanguage = 'both'; // 'zh', 'en', 'both'
        let analysisData = null;
        
        function toggleLanguage() {
            const options = ['both', 'zh', 'en'];
            const currentIndex = options.indexOf(currentLanguage);
            currentLanguage = options[(currentIndex + 1) % options.length];
            
            const bilingualElements = document.querySelectorAll('.bilingual');
            bilingualElements.forEach(element => {
                const zhElement = element.querySelector('.zh');
                const enElement = element.querySelector('.en');
                
                if (currentLanguage === 'zh') {
                    zhElement.style.display = 'block';
                    enElement.style.display = 'none';
                } else if (currentLanguage === 'en') {
                    zhElement.style.display = 'none';
                    enElement.style.display = 'block';
                } else {
                    zhElement.style.display = 'block';
                    enElement.style.display = 'block';
                }
            });
            
            // Update language toggle button
            const toggleBtn = document.querySelector('.language-toggle');
            if (currentLanguage === 'zh') {
                toggleBtn.textContent = '‰∏≠Êñá';
            } else if (currentLanguage === 'en') {
                toggleBtn.textContent = 'English';
            } else {
                toggleBtn.textContent = '‰∏≠/EN';
            }
        }
        
        function formatPrice(price) {
            if (!price) return '--';
            return new Intl.NumberFormat('zh-TW').format(Math.round(price));
        }
        
        function formatPercentage(value) {
            if (value === null || value === undefined || isNaN(value)) return '--';
            return `${value.toFixed(1)}%`;
        }
        
        function getRecommendationColor(rec) {
            switch(rec) {
                case 'BUY': return 'bullish';
                case 'SELL': return 'bearish'; 
                case 'HOLD': return 'neutral';
                default: return 'neutral';
            }
        }
        
        function getRecommendationText(rec, lang = 'both') {
            const texts = {
                'BUY': { zh: 'Âª∫Ë≠∞Ë≤∑ÈÄ≤', en: 'BUY' },
                'SELL': { zh: 'Âª∫Ë≠∞Ë≥£Âá∫', en: 'SELL' },
                'HOLD': { zh: 'Âª∫Ë≠∞ÊåÅÊúâ', en: 'HOLD' }
            };
            
            const text = texts[rec] || { zh: 'ÂàÜÊûê‰∏≠', en: 'Analyzing' };
            
            if (lang === 'zh') return text.zh;
            if (lang === 'en') return text.en;
            return `${text.zh} | ${text.en}`;
        }
        
        function updateDisplay(data) {
            if (!data) return;
            
            analysisData = data;
            
            // Update prices
            const currentPrice = data.price?.current || 0;
            const high24h = data.price?.high_24h || 0;
            const low24h = data.price?.low_24h || 0;
            const volume24h = data.price?.volume_24h || 0;
            
            document.getElementById('currentPrice').textContent = `$${formatPrice(currentPrice)} TWD`;
            document.getElementById('currentPriceSmall').textContent = `$${formatPrice(currentPrice)}`;
            document.getElementById('high24h').textContent = `$${formatPrice(high24h)}`;
            document.getElementById('low24h').textContent = `$${formatPrice(low24h)}`;
            document.getElementById('volume24h').textContent = volume24h.toFixed(2);
            
            // Calculate price change
            if (high24h && low24h) {
                const changePercent = ((currentPrice - low24h) / low24h * 100).toFixed(2);
                const changeElement = document.getElementById('priceChange');
                changeElement.textContent = `${changePercent > 0 ? '+' : ''}${changePercent}%`;
                changeElement.className = `price-change ${changePercent >= 0 ? 'positive' : 'negative'}`;
            }
            
            // Update AI recommendation
            const aiAnalysis = data.ai_analysis || {};
            const recommendation = aiAnalysis.recommendation || 'HOLD';
            const confidence = aiAnalysis.confidence || 0;
            
            const recElement = document.getElementById('aiRecommendation');
            recElement.textContent = getRecommendationText(recommendation, currentLanguage);
            recElement.className = `rec-action ${getRecommendationColor(recommendation)}`;
            
            document.getElementById('aiConfidence').textContent = 
                currentLanguage === 'zh' ? `ÁΩÆ‰ø°Â∫¶: ${confidence.toFixed(1)}%` :
                currentLanguage === 'en' ? `Confidence: ${confidence.toFixed(1)}%` :
                `ÁΩÆ‰ø°Â∫¶ | Confidence: ${confidence.toFixed(1)}%`;
            
            // Update technical indicators
            const technical = aiAnalysis.technical_values || {};
            document.getElementById('ma7').textContent = formatPrice(technical.ma7);
            document.getElementById('ma25').textContent = formatPrice(technical.ma25);
            document.getElementById('macd').textContent = technical.macd ? technical.macd.toFixed(0) : '--';
            document.getElementById('rsi').textContent = technical.rsi ? technical.rsi.toFixed(1) : '--';
            document.getElementById('bollinger').textContent = technical.bb_position ? 
                (technical.bb_position * 100).toFixed(0) + '%' : '--';
            document.getElementById('volume').textContent = technical.volume_ratio ? 
                (technical.volume_ratio * 100).toFixed(0) + '%' : '--';
            
            // Update probabilities
            const bullishScore = aiAnalysis.bullish_score || 0;
            const bearishScore = aiAnalysis.bearish_score || 0;
            const totalScore = Math.abs(bullishScore) + Math.abs(bearishScore);
            
            if (totalScore > 0) {
                const bullishProb = (Math.abs(bullishScore) / totalScore * 100);
                const bearishProb = (Math.abs(bearishScore) / totalScore * 100);
                
                document.getElementById('bullishProb').textContent = formatPercentage(bullishProb);
                document.getElementById('bearishProb').textContent = formatPercentage(bearishProb);
            } else {
                document.getElementById('bullishProb').textContent = '50%';
                document.getElementById('bearishProb').textContent = '50%';
            }
            
            // Mock news sentiment data
            document.getElementById('positiveNews').textContent = Math.floor(Math.random() * 20 + 10);
            document.getElementById('neutralNews').textContent = Math.floor(Math.random() * 30 + 20);
            document.getElementById('negativeNews').textContent = Math.floor(Math.random() * 15 + 5);
            
            // Update trading advice
            let advice = '';
            if (currentLanguage === 'zh') {
                advice = `Áï∂ÂâçÂ∏ÇÂ†¥${recommendation === 'BUY' ? 'ÁúãÊº≤' : recommendation === 'SELL' ? 'ÁúãË∑å' : '‰∏≠ÊÄß'}ÔºåÂª∫Ë≠∞${getRecommendationText(recommendation, 'zh')}„ÄÇÁΩÆ‰ø°Â∫¶${confidence.toFixed(1)}%ÔºåË´ãË¨πÊÖéÊìç‰Ωú„ÄÇ`;
            } else if (currentLanguage === 'en') {
                advice = `Market is currently ${recommendation === 'BUY' ? 'bullish' : recommendation === 'SELL' ? 'bearish' : 'neutral'}. ${getRecommendationText(recommendation, 'en')} with ${confidence.toFixed(1)}% confidence. Trade carefully.`;
            } else {
                advice = `Áï∂ÂâçÂ∏ÇÂ†¥${recommendation === 'BUY' ? 'ÁúãÊº≤' : recommendation === 'SELL' ? 'ÁúãË∑å' : '‰∏≠ÊÄß'}ÔºåÂª∫Ë≠∞${getRecommendationText(recommendation, 'zh')}„ÄÇ | Market ${recommendation === 'BUY' ? 'bullish' : recommendation === 'SELL' ? 'bearish' : 'neutral'}, ${getRecommendationText(recommendation, 'en')} with ${confidence.toFixed(1)}% confidence.`;
            }
            
            document.getElementById('tradingAdvice').textContent = advice;
        }
        
        async function fetchAnalysis() {
            try {
                const response = await fetch('/api/analysis');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                const data = await response.json();
                updateDisplay(data);
            } catch (error) {
                console.error('Failed to fetch analysis:', error);
                
                // Show error in display
                const elements = ['currentPrice', 'aiRecommendation'];
                elements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = 'Connection Error | ÈÄ£Êé•ÈåØË™§';
                        element.className += ' negative';
                    }
                });
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initial fetch
            fetchAnalysis();
            
            // Update every 10 seconds
            setInterval(fetchAnalysis, 10000);
            
            // Add some initial animation
            setTimeout(() => {
                document.querySelectorAll('.indicator, .info-item, .prob-item, .sentiment-item').forEach((element, index) => {
                    element.style.opacity = '0';
                    element.style.transform = 'translateY(20px)';
                    element.style.transition = 'all 0.5s ease';
                    
                    setTimeout(() => {
                        element.style.opacity = '1';
                        element.style.transform = 'translateY(0)';
                    }, index * 100);
                });
            }, 500);
        });
    </script>
</body>
</html> 
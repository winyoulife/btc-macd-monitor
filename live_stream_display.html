<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>🚀 BTC直播监控 🚀</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a23, #1a1a2e, #16213e);
            color: #00ff88;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: rgba(0,0,0,0.9);
            padding: 20px 0;
            text-align: center;
            border-bottom: 3px solid #00ff88;
        }
        
        .title {
            font-size: 3.5em;
            text-shadow: 0 0 30px #00ff88;
            animation: glow 2s ease-in-out infinite alternate;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.5em;
            color: #ffaa00;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 30px #00ff88; }
            to { text-shadow: 0 0 50px #00ff88, 0 0 60px #00ff88; }
        }
        
        .main-content {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
            align-items: center;
        }
        
        .price-section {
            text-align: center;
            background: rgba(0,0,0,0.8);
            border: 3px solid #00ff88;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 0 40px rgba(0,255,136,0.3);
        }
        
        .price-label {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #ffaa00;
        }
        
        .current-price {
            font-size: 6em;
            font-weight: bold;
            margin: 30px 0;
            text-shadow: 0 0 20px #00ff88;
            animation: pulse 3s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .price-change {
            font-size: 2.5em;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .signals-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .signal-box {
            background: rgba(0,20,40,0.9);
            border: 3px solid;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .buy-signal {
            border-color: #00ff00;
            background: rgba(0,255,0,0.1);
        }
        
        .sell-signal {
            border-color: #ff4444;
            background: rgba(255,68,68,0.1);
        }
        
        .signal-title {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .signal-status {
            font-size: 4em;
            font-weight: bold;
            margin: 10px 0;
            animation: flash 2s ease-in-out infinite;
        }
        
        .signal-strength {
            font-size: 1.8em;
            margin-top: 10px;
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .market-info {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.9);
            padding: 15px;
            text-align: center;
            border-top: 2px solid #00ff88;
            font-size: 1.3em;
            display: flex;
            justify-content: space-around;
        }
        
        .info-item {
            color: #ffaa00;
        }
        
        .update-time {
            position: fixed;
            top: 10px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #00ff88;
            font-size: 1.1em;
        }
        
        /* 响应式设计 */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .current-price {
                font-size: 5em;
            }
            .signal-status {
                font-size: 3em;
            }
        }
        
        /* 强调颜色 */
        .green { color: #00ff00; background: rgba(0,255,0,0.1); }
        .red { color: #ff4444; background: rgba(255,68,68,0.1); }
        .yellow { color: #ffaa00; background: rgba(255,170,0,0.1); }
    </style>
</head>
<body>
    <div class="update-time" id="updateTime">
        最後更新: --
    </div>

    <div class="header">
        <div class="title">🚀 BTC 直播监控站 🚀</div>
        <div class="subtitle">📊 实时价格 | 🎯 交易信号 | 💰 投资参考</div>
    </div>

    <div class="main-content">
        <!-- 价格显示区 -->
        <div class="price-section">
            <div class="price-label">💰 BTC/USDT</div>
            <div class="current-price" id="currentPrice">載入中...</div>
            <div class="price-change" id="priceChange">--</div>
        </div>

        <!-- 交易信号区 -->
        <div class="signals-section">
            <div class="signal-box buy-signal" id="buySignalBox">
                <div class="signal-title" style="color: #00ff00;">
                    📈 买入信号
                </div>
                <div class="signal-status" id="buySignalStatus">
                    检测中...
                </div>
                <div class="signal-strength" id="buySignalStrength">
                    --
                </div>
            </div>

            <div class="signal-box sell-signal" id="sellSignalBox">
                <div class="signal-title" style="color: #ff4444;">
                    📉 卖出信号
                </div>
                <div class="signal-status" id="sellSignalStatus">
                    检测中...
                </div>
                <div class="signal-strength" id="sellSignalStrength">
                    --
                </div>
            </div>
        </div>
    </div>

    <div class="market-info">
        <div class="info-item">
            24H高: <span id="high24h">--</span>
        </div>
        <div class="info-item">
            24H低: <span id="low24h">--</span>
        </div>
        <div class="info-item">
            成交量: <span id="volume24h">--</span>
        </div>
        <div class="info-item">
            市值: <span>#1</span>
        </div>
    </div>

    <script>
        // 全局变量
        let priceData = [];
        let currentPrice = 0;
        let previousPrice = 0;

        // 计算技术指标（简化版）
        function calculateIndicators(prices) {
            if (prices.length < 26) return null;
            
            // 计算MACD
            const macd = calculateMACD(prices);
            
            // 计算RSI
            const rsi = calculateRSI(prices, 14);
            
            // 计算布林通道
            const bb = calculateBollingerBands(prices, 20, 2);
            
            // 计算移动平均
            const ma5 = calculateMA(prices, 5);
            const ma10 = calculateMA(prices, 10);
            
            return { macd, rsi, bb, ma5, ma10 };
        }

        // MACD计算
        function calculateMACD(prices) {
            const ema12 = calculateEMA(prices, 12);
            const ema26 = calculateEMA(prices, 26);
            
            if (!ema12 || !ema26) return null;
            
            const macdLine = ema12 - ema26;
            const signal = calculateEMA([macdLine], 9);
            const histogram = macdLine - (signal || 0);
            
            return { macdLine, signal, histogram };
        }

        // RSI计算
        function calculateRSI(prices, period) {
            if (prices.length < period + 1) return null;
            
            let gains = 0, losses = 0;
            
            for (let i = prices.length - period; i < prices.length; i++) {
                const change = prices[i] - prices[i-1];
                if (change > 0) gains += change;
                else losses -= change;
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            
            if (avgLoss === 0) return 100;
            
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }

        // 布林通道计算
        function calculateBollingerBands(prices, period, multiplier) {
            if (prices.length < period) return null;
            
            const recentPrices = prices.slice(-period);
            const sma = recentPrices.reduce((a, b) => a + b) / period;
            
            const variance = recentPrices.reduce((sum, price) => {
                return sum + Math.pow(price - sma, 2);
            }, 0) / period;
            
            const stdDev = Math.sqrt(variance);
            
            return {
                upper: sma + (stdDev * multiplier),
                middle: sma,
                lower: sma - (stdDev * multiplier)
            };
        }

        // EMA计算
        function calculateEMA(prices, period) {
            if (prices.length < period) return null;
            
            const multiplier = 2 / (period + 1);
            let ema = prices[0];
            
            for (let i = 1; i < prices.length; i++) {
                ema = (prices[i] * multiplier) + (ema * (1 - multiplier));
            }
            
            return ema;
        }

        // 移动平均计算
        function calculateMA(prices, period) {
            if (prices.length < period) return null;
            
            const recentPrices = prices.slice(-period);
            return recentPrices.reduce((a, b) => a + b) / period;
        }

        // 更新交易信号（简化版，适合直播）
        function updateTradingSignals(indicators) {
            if (!indicators) return;
            
            let buyCount = 0, sellCount = 0;
            
            // 检查买入条件
            const macdBuy = indicators.macd && indicators.macd.histogram > 0;
            const rsiBuy = indicators.rsi && indicators.rsi < 30;
            const maBuy = indicators.ma5 && indicators.ma10 && 
                         priceData[priceData.length - 1] > indicators.ma5;
            const bbBuy = indicators.bb && 
                         priceData[priceData.length - 1] < indicators.bb.lower;
            
            buyCount = [macdBuy, rsiBuy, maBuy, bbBuy].filter(Boolean).length;
            
            // 检查卖出条件
            const macdSell = indicators.macd && indicators.macd.histogram < 0;
            const rsiSell = indicators.rsi && indicators.rsi > 70;
            const maSell = indicators.ma5 && indicators.ma10 && 
                          priceData[priceData.length - 1] < indicators.ma5;
            const bbSell = indicators.bb && 
                          priceData[priceData.length - 1] > indicators.bb.upper;
            
            sellCount = [macdSell, rsiSell, maSell, bbSell].filter(Boolean).length;
            
            // 更新买入信号显示
            updateSignalDisplay('buy', buyCount, 4);
            
            // 更新卖出信号显示
            updateSignalDisplay('sell', sellCount, 4);
        }

        function updateSignalDisplay(type, count, total) {
            const percentage = (count / total) * 100;
            let status, strength, color;
            
            if (percentage >= 75) {
                status = '🔥 强烈';
                strength = `${count}/${total} 条件满足`;
                color = type === 'buy' ? '#00ff00' : '#ff4444';
            } else if (percentage >= 50) {
                status = '⚡ 中等';
                strength = `${count}/${total} 条件满足`;
                color = '#ffaa00';
            } else if (percentage >= 25) {
                status = '⚠️ 弱';
                strength = `${count}/${total} 条件满足`;
                color = '#ffaa00';
            } else {
                status = '❌ 无';
                strength = `${count}/${total} 条件满足`;
                color = '#666';
            }
            
            document.getElementById(`${type}SignalStatus`).textContent = status;
            document.getElementById(`${type}SignalStatus`).style.color = color;
            document.getElementById(`${type}SignalStrength`).textContent = strength;
        }

        // 获取BTC价格
        async function fetchBTCPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_high_low_24h=true');
                const data = await response.json();
                
                previousPrice = currentPrice;
                currentPrice = data.bitcoin.usd;
                
                // 更新价格显示
                document.getElementById('currentPrice').textContent = 
                    `$${currentPrice.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
                
                // 更新价格变化
                const change = data.bitcoin.usd_24h_change;
                const changeElement = document.getElementById('priceChange');
                changeElement.textContent = 
                    `24H: ${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                
                // 设置价格变化颜色
                if (change >= 0) {
                    changeElement.className = 'price-change green';
                } else {
                    changeElement.className = 'price-change red';
                }
                
                // 更新市场数据
                document.getElementById('high24h').textContent = 
                    `$${Math.round(data.bitcoin.usd_24h_high || 0).toLocaleString()}`;
                document.getElementById('low24h').textContent = 
                    `$${Math.round(data.bitcoin.usd_24h_low || 0).toLocaleString()}`;
                document.getElementById('volume24h').textContent = 
                    `$${(data.bitcoin.usd_24h_vol / 1000000000).toFixed(1)}B`;
                
                // 添加到价格数据
                priceData.push(currentPrice);
                if (priceData.length > 50) {
                    priceData.shift();
                }
                
                // 计算技术指标
                const indicators = calculateIndicators(priceData);
                updateTradingSignals(indicators);
                
                // 更新时间
                document.getElementById('updateTime').textContent = 
                    `最後更新: ${new Date().toLocaleTimeString('zh-TW')}`;
                
            } catch (error) {
                console.error('获取价格失败:', error);
                document.getElementById('currentPrice').textContent = '获取失败';
            }
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            fetchBTCPrice();
            
            // 每30秒更新一次
            setInterval(fetchBTCPrice, 30000);
        });
    </script>
</body>
</html> 
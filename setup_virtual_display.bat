@echo off
echo Setting up virtual display and starting stream...
ssh -i C:\Users\tracy\.ssh\ssh-key-2025-06-02.key ubuntu@193.123.161.19 "sudo apt update && sudo apt install -y xvfb"
echo Installing virtual display...
ssh -i C:\Users\tracy\.ssh\ssh-key-2025-06-02.key ubuntu@193.123.161.19 "pkill ffmpeg; pkill Xvfb"
echo Starting virtual display...
ssh -i C:\Users\tracy\.ssh\ssh-key-2025-06-02.key ubuntu@193.123.161.19 "nohup Xvfb :99 -screen 0 1920x1080x24 > /dev/null 2>&1 &"
echo Waiting for display to start...
timeout /t 5
echo Starting stream...
ssh -i C:\Users\tracy\.ssh\ssh-key-2025-06-02.key ubuntu@193.123.161.19 "export DISPLAY=:99.0 && nohup ffmpeg -f x11grab -video_size 1920x1080 -framerate 30 -i :99.0 -c:v libx264 -preset ultrafast -maxrate 2500k -bufsize 5000k -pix_fmt yuv420p -g 50 -f flv rtmp://a.rtmp.youtube.com/live2/f8bd-vduf-ycuf-s1ke-atbb > ~/stream_new.log 2>&1 &"
echo Stream should be starting now!
pause 